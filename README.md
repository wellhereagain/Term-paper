# Term paper

### Вступление

Банковская система является одним из ключевых элементов экономики любой страны. Ее состояние и развитие напрямую влияют на финансовую стабильность и устойчивость экономики в целом. В России, как и в других странах, Центральный банк играет важную роль в регулировании банковской системы через изменение ключевой ставки. Поэтому, изучение реакции показателей банковской системы на изменение ключевой ставки ЦБ РФ является актуальной темой для исследования.

В данной работе будет реализовано моделирование временных рядов для анализа взаимосвязи и между изменением ключевой ставки ЦБ РФ и показателями банковской системы. Будут рассмотрены такие показатели, как процентные ставки по депозитам, объемы выданных кредитов, объемы привлеченных депозитов, финансовые результаты деятельности кредитных организаций, объем неплатежей по кредитам, структурный баланс ликвидности банковского сектора. 

Целью данной работы является выявление степени влияния изменения ключевой ставки ЦБ РФ на показатели банковской системы и оценка реакции банков на эти изменения. 

### Обзор литературы

В рамках обзора литературы мы выполняем следующие задачи: 

1. Обзор существующих исследований на тему монетарной политики и ее влияния на банковскую систему в России и других странах.
2. Рассмотрение различных подходов к моделированию влияния монетарной политики на банковскую систему, методологических ограничений и проблем

**Обзор существующих исследований** 

Обзор существующих исследований на тему монетарной политики и ее влияния на банковскую систему в России и других странах показывает, что данная проблема является актуальной и вызывает интерес у экономистов по всему миру. Некоторые исследования эмпирически подтверждают теоретические преопосылке о монетарном влиянии на банковскую систему и кредитное поведение компаний. Другие исследования, однако, указывают на то, что эффекты монетарной политики на банковскую систему могут быть незначительными, так как существуют институциональные ограничения, препятствующие трансмиссионному механизму монетараной политики.

Далее рассмотрим конкретные примеры исследований в аспектах: *рассмотренный вид монетарной политики;* *на какие показатели банковского сектора влияет.* 

Самый широкий подход к моделированию влияния монетарной политики представлен в работе Мамонов М. и др. (2017), где исследователи Банка России моделируют измерение целых групп показателей, которые относятся к размеру и структуре финансового сектора, в том числе расширяя прогноз и на не-банковские организации. В качестве признаков для модели авторы используют не только данные о монетарной политике - в модель входят макроэкономические, финансовые, демографические и институциональные характеристики. “Чистых” показателей монетарной политики в переменных работы нет, среди наиболее определяемых ЦБ переменных: номинальный обменный курс и номинальная процентная ставка.  

В другой группе исследований авторы cтроят более узкие модели и моделируют влияение монетарной политики на объемы активов и депозитов в банковском секторе. В работе Krainer R. (2014) представлен обзор эффекта монетарной политики на объем кредитования и вкладов на примере США. В качестве прокси-переменной используется дельта ставки федеральных фондов, которая представляется сильно скореллированной с ключевой ставкой и направление ее изменение, как правило, отражает желаемый эффект политики монетарных властей. Исследование Salmanov O. и др. (2017) концентрируется на российской специфика, изучая влияние монетарной политики на объемы корпоративного кредитования. В этой работе за монетарную политику отвечают такие показатели,  как денежная масса, денежная база и ставка рефинансирования (ключевая ставка). 

В работах Дробышевский С. и др. (2009), Juurikkala T. и др. (2009) был проведен анализ того, как денежно-кредитная политика Центрального банка влияет на ставку межбансковского кредита в России за период 1999-2007 годов. В рамках работы Леонтьевой Е. (2013) был рассмотрены эффекты ставки рефинансирования, процентных ставок на банковские вклады в Банке России,  ставки репо на объемы банковского кредитования. 

Данные работы можно аккуратно назвать устаревшими, так как большинство не учитывают существующую российскую специфику, а именно состоявшийся в 2014 переход ЦБ РФ от таргетирвования валютного курса к таргетированию процентной ставки, что должно было усилить влияние монетарной политики на показатели банковского сектора. Кроме того, череда произошедших в 2020-2022 внешних шоков могла повлиять на эффективность трансмиссии монетарной политики. 

**Рассмотрение различных подходов к моделированию влияния монетарной политики на банковскую систему, методологических ограничений и проблем**

*Для экономии места в таблице используется индексация в соответствие со списком литературы.* 

| Метод | Работы | Краткое описание метода | Преимущества метода  | Ограничения метода |
| --- | --- | --- | --- | --- |
| 2SLS-BMA алгоритм (2-Stage Least Squares Bayesian Model Averaging) | 13 | Состоит из двух этапов: первый этап - это 2SLS (2-Stage Least Squares), который позволяет учесть эндогенность переменных, а второй этап - это Bayesian Model Averaging (BMA), который позволяет учитывать неопределенность в выборе модели.  | 2SLS Решает проблему эндогенности. BMA позволяет учитывать неопределенность в данных. | - Необходим достаточно большой объем выборки для получения надежных результатов.  |
| Агентная модель  | 14 | модель, в которой экономика разбивается на отдельные агенты, каждый из которых имеет свои цели и стратегии поведения | - может учитывать нелинейные эффекты и динамические изменения | - сложность ее построения и вычислений, необходимость учета большого количества параметров и ограничений на данные, а также возможность возникновения неустойчивости и неоднозначности результатов. - агентная модель может быть чувствительна к выбору начальных условий и параметров, что может привести к ошибочным выводам. |
| Байесовской векторная авторегрессия | 14 | Оценки параметров модели получаются путем совместного использования данных и априорных распределений.  | BVAR позволяет учитывать неопределенность в данных.  |  - Необходим достаточно большой объем выборки для получения надежных результатов - Необходимость выбора априорных распределений для параметров модели |
| Метод многошаговых прогнозов (multi-step forecasting) | 19 | параметры модели выбираются так, чтобы минимизировать функционал ошибок out-of-sample прогноза на заданное число шагов. | - на российских данных строит прогнозы несколько лучше, чем ARIMAX и значительно лучше, чем AR, ARIMA, VAR, VARX - устойчивость параметров | - возможно плохое качество на длительном периоде прогнозирования |
| Обобщенный метод моментов | 22, 29 | Оцениваются параметры модели, которые минимизируют расхождение между выборочными моментами и теоретическими моментами, полученными из модели | - может быть использован для оценки параметров в моделях с нелинейными ограничениями - может быть использован для оценки параметров в моделях с пропущенными данными. | -чувствительность к выбору моментных условий - возможность получения неустойчивых оценок при небольших выборках. |
| Granger causality test | 25, 30 | Основывается на предположении, что если временной ряд X содержит информацию, которая может помочь в прогнозировании временного ряда Y, то можно говорить о том, что X вызывает Y. Работа метода заключается в проведении регрессионного анализа, в котором один из временных рядов выступает в качестве зависимой переменной, а другой - в качестве независимой. Затем анализируются статистические показатели, такие как коэффициент детерминации и F-статистика, чтобы определить, является ли один временной ряд причиной изменений в другом | - простота - определение связи причина-следствие | - возможность получения ложноположительных результатов при наличии скрытых факторов, которые могут влиять на оба временных ряда. |
| Регрессионные модели | 23, 24, 26 | Регрессионная модель с прогнозированием на один шаг вперед, используя только текущее значение объясняющей переменной | Простота построения | Все недостатки линейных моделей  |
| VAR (векторная авторегрессия) | 27, 28 | VAR использует авторегрессионную структуру для описания зависимости каждой переменной от ее собственного лага и лагов других переменных.  | - Включение лагов - Вычислительная простота по сравнению с BVAR | - все преимущества BVAR  |

### Методология

Так как работа учебная, хотелось бы попробовать различные методы моделирования временных рядов. 

В частности: 

1. ARIMA (Autoregressive Integrated Moving Average)
2. SARIMA (Seasonal Autoregressive Integrated Moving Average)
3. VAR (Vector Autoregression) 
4. BVAR (Baesian Vector Autoregression) 
5. Exponential Smoothing 
6. Модель с трансформерами (с энкодер-декодерной архитектурой). 

Включение определенных лагов в модели будет обоснованно после визуального и корреляционного анализа. В модели в качестве признаков будет включено текущее значение ключевой ставки. 

Моделирование планируется реализовать на Python с помощью библиотеки для анализа временных рядов [ETNA](https://etna.tinkoff.ru). 

Качество моделей будет оценено по метрикам SMAPE, MAE. 

### Данные

Показатели банковской системы, которые будут использованы для анализа влияния изменения ключевой ставки (с 2008 года, усредненная помесячно) 

1. Максимальная процентная ставка по депозитам: с 2009, усредненная помесячно
2. Объемы выданных кредитов в разбивке физические лица/огранизации: с 2019, помесячно 
3. Объемы привлеченных депозитов в разбивке физические лица/огранизации: с 2019, помесячно 
4. Структурный дефицит/профицит ликвидности банковского сектора: с 2018, усредненная помесячно
5. Объем неплатежей по кредитам физических лиц: с 2019, помесячно 
6. Общий объем прибыли/ убытков, полученных действующими кредитными организациями: с 2019, помесячно 

Предобработанные и сырые данные лежат в папке data, код для обработки сырых данных лежат в файле data_preprocessing

### Модели

**По результатам работы были построены следующие модели**

- Naive model в качестве baseline
- SARIMAX (лаги 1-3, подбирались перебором гиперпараметров)
- AUTOARIMA (лаги 1-3)
- CatBoostPerSegment Model (лаги 1-2)
- CatBoostMultisegment Model (лаги 1-2)
- Exponential Smoothing models: Holt Model, Holt-Winter Model  (лаги 1-3)


**Разведывательный анализ**

- Распределения данных

Изначальные 

![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/initial_dist_1.png)
![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/initial_dist_2.png)

Сезонность

![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/initial_seas_1.png)
![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/initial_seas_2.png)

Тренд

![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/initial_trend_1.png)
![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/initial_trend_2.png)

Даже визуальным анализом заметно, что некоторые ряды имеют нестационарность. Для переменных запаса (Объем неплатежей по кредитам физических лиц, Объемы привлеченных депозитов в огранизациях, Объемы выданных кредитов в разбивке физические лица/огранизации) мы перешли к разностям, чтобы устранить нестационарность

После перехода в разности

![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/dist_1.png)
![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/dist_2.png)

ACF
![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/acf_1.png)
![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/acf_2.png)

**Результаты**

Каждая из рассматриваемых моделей строилась с регрессором - ключевой ставкой - и без нее. Таким образом, влияние ключевой ставки будет рассмотрено через изменение ошибки прогноза. 

Как мы изменяем качество моделей: SMAPE, MAE
- Naive model

![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/naive_model.png)

- SARIMAX

![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/sarimax.png)

![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/sarimax_forecast_1.png)
![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/sarimax_forecast_2.png)

- AUTOARIMA
  
![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/autoarima.png)

- CatBoostPerSegment Model

С учетом ставки
![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/catboost_ps.png)

Без учета ставки
![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/catboost_ps_without.png)

- CatBoostMultisegment Model

С учетом ставки
![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/catboost_ms.png)

Без учета ставки
![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/catboost_ms_without.png)
  
- Exponential Smoothing models: Holt Model, Holt-Winter Model

Holt Model
![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/holt.png)


Holt-Winter Model 
![Image alt](https://github.com/wellhereagain/Term-paper/blob/main/holt_wiinter.png)

**Выводы**
Самый успешный класс моделей по агрегированным метрикам - модели с экпоненциальным сглаживанием, , 

Почему такие вялые результаты и что можно улучшить: 

- Размерность и глубина данных: в данный момент мы использовали данные за 47 месяцев, усредняя значение ставки помесячно - можем предположить, что для анализа прямого эффекта необходимы подневные данные.
- Другие функциональные формы модели



### Литература

Исходные тексты использованных исследований приведены в папке texts 

1. Salmanov O., Zayernyuk V., Lopatina O. An Analysis of the impact of monetary policy on bank lending in Russia //Asian Social Science. 2015. Т. 11.  №. 6. [22]
2. Ono S. Bank lending channel in monetary policy transmission: Evidence from Russia //International Journal of Economics and Finance. 2015. Т. 7.  №. 4. С. 1-11. [23]
3. Fungáčová Z., Nuutilainen R., Weill L. Reserve requirements and the bank lending channel in China //Journal of Macroeconomics. 2016. Т. 50. С. 37-50. [24]
4. Krainer R. E. Monetary policy and bank lending in the Euro area: Is there a stock market channel or an interest rate channel? //Journal of International Money and Finance. 2014.  Т. 49. С. 283-298 [25]
5. Kashyap A. K., Stein J. C. The impact of monetary policy on bank balance sheets //Carnegie-Rochester conference series on public policy. North-Holland, 1995. Т. 42.  С. 151-195.[26] 
6. Vymyatnina Y. How much control does Bank of Russia have over money supply? //Research in international business and finance.  2006.  Т. 20. №. 2. С. 131-144. [27] 
7. Дробышевский С. М., Трунин П. В., Каменских М. В. Анализ правил денежно-кредитной политики Банка России в 1999–2007 гг //Научные труды Фонда «Институт экономической политики им. ЕТ Гайдара». 2009.  №. 127.  С. 1-88.[28]
8. Juurikkala T., Karas A., Solanko L. The role of banks in monetary policy transmission: Empirical evidence from Russia //Review of international economics. 2011. Т. 19.  №. 1.  С. 109-121.  [29]
9. Leontyeva E. Механизм Кредитно-Денежной Трансмиссии в России (The Mechanism of Monetary Transmissions in Russia) //Available at SSRN 2264166. 2013.  [30]
10. Мамонов М., Пестова А., Панкова В., Ахметов Р., Солнцев О. Долгосрочное прогнозирование размера и структуры финансового сектора России // Банк России. Сер. докладов об экономических исследованиях. 2017. No 20. С. 1-45. [13.]
11. Пономаренко А., Селезнев С., Хабибуллин Р. Прогнозирование последствий накопления международных резервов при помощи агентной модели // Банк России. Сер. докладов об экономических исследованиях. 2018. No 37. С. 1-35. [14]
12. Моисеев А.К., Черковец М.В. Сценарный прогноз динамики процентных ставок и объема внутреннего кредита в России в 2018-2022 гг. // Проблемы прогнозирования. 2018. No 5. С. 73-80. [18]
13. Пильник Н.П., Радионов С.А., Языков А.А. Модель оптимального поведения современной российской банковской системы // Экономический журнал ВШЭ. 2018. No 3. С. 418-447.[19]
14. Пильник Н. П., Поспелов И. Г., Радионов С. А. О пределах влияния ключевой ставки Банка России на показатели российской банковской системы //Проблемы прогнозирования. – 2020. – №. 2 (179). – С. 137-147.
